---
title: "EDA heart attack analysis prediction"
output: html_document
---

## Data loading
```{r}
df<-read.csv("C:/Users/Vikas/Desktop/EDA LA1/heart.CSV")
head(df)
```
## The type of object can be ascertained using the class() command
```{r}
class(df)
class(df$age)
class(dimnames(df))
```
## Shows the top of the data object and by default shows the first six rows:
```{r}
head(df)
```
## Can elect to show a different number of rows using the n = instruction like so:
```{r}
head(df, n=3)
```
## can also display the bottom of the data using the tail() command default shows the last six rows:
```{r}
tail(df)
```
## Can select to show a different number of rows using the n = instruction like so:
```{r}
tail(df, n=4)
```
##To get information about an Data frame and particular columns:
```{r}
summary(df)
```
```{r}
summary(df$age)
```
```{r}
mean(df$age)
```
```{r}
median(df$age)
```
## Shows the median absolute deviation
```{r}
mad(df$trtbps)
```
```{r}
mode(df$trtbps)
```
```{r}
var(df$trtbps)
```
```{r}
sd(df$trtbps)
```
```{r}
quantile(df$trtbps)
```
## Returns Tukey’s five number summary (minimum, lower-hinge, median, upper-hinge, maximum) for the input data.
```{r}
fivenum(df$trtbps)
```
## F Test to Compare Two Variances
```{r}
var.test(df$age, df$trtbps)
```
## str() command is useful to see the object structure
```{r}
str(df)
```
## structure returns the given object with further attributes set
```{r}
head(structure(df))
```
## can also look at all the named objects you have at once using the ls.str() command
```{r}
ls.str(df)
```
## can use the pattern = instruction to narrow down your focus
```{r}
ls.str(pattern = 'df')
```
## The most basic command that enables the viewing of column or row is:
```{r}
names(df)
```
```{r}
row.names(df)

```
## length() command used to determine the number of items in an object
```{r}
length(df)
```
## To extract a particular column and particular row values
```{r}
head(df$age)
```
```{r}
df$trtbps[3]
```
```{r}
df$age[1:5]
```
```{r}
tdf = attach(df)
tdf
```
## The max() and min() commands display the largest and smallest values in a numeric object
```{r}
max(df$age)
```
```{r}
max(df$trtbps)
```
```{r}
min(df$age)
```
```{r}
min(df$trtbps)
```
```{r}
head(stack(df))
```
## Sorting default is ascending order
```{r}
head(sort(df$age))
```
```{r}
head(sort(df$trtbps))
```
## can get an index using the order() command. This uses the same instructions as the sort() command, but tells you the position of each item along the vector:
```{r}
head(order(df$age))

```
## The rank() command gives the rank number like order() in a slightly different manner when the values are same the ranks are shared between them which is not in order()
```{r}
head(rank(df$cp), n=10)


```
## Displaying selected rows & columns
```{r}
df[3,3]

```
```{r}
df[3, 1:5]
```
## To convert from Data frame from matrix
```{r}
head(as.matrix(df))

```
## The cbind() and rbind() commands assemble a matrix/data frames, by columns or rows, from several other object

```{r}
head(rbind(df))
```

```{r}
head(cbind(df))
```
## Simple Cumulative Commands
```{r}
head(cumsum(df$thall))

```
```{r}
head(cummax(df$thall))
```

```{r}
head(cummin(df$thall))
```
## The cumulative product
```{r}
head(cumprod(df$thall))
```
## The table() command enables you to specify which columns of data you want to use to create your contingency table
```{r}
table(df$thall)
```
```{r}
head(as.table(df$thall))
```
## To check whether the data extracted is data frame or not
```{r}
is.data.frame(df)
```
```{r}
is.table(df)

```
## The class() command can form the basis of a logical test by using the if() command in the following manner:
```{r}
if(class(df) == 'data.frame') TRUE else FALSE
```
## The seq_along() command creates a simple index
```{r}
seq_along(df)

```
## Create a basic stem and leaf plot using the stem() command
```{r}
stem(df$age)
```
## Now increase the number of bins used by adding a scale = 2 instruction
```{r}
stem(df$age, scale = 2)
```
## stem with a conditional statement:
```{r}
with(df, stem(df$trtbps[df$sex == 0]))
```
## Histogram Plotting:
```{r}
```


```{r}
hist(df$age)
```
```{r}
hist(df$trtbps)
```
```{r}
hist(df$thall)
```
```{r}
hist(df$trtbps, col = 'lightblue', xlab = 'trtbps', ylim = c(0, 0.1), freq = FALSE)
```
## Have seen in drawing a histogram with the hist() command that you can use freq = FALSE to force the y-axis to display the density rather than the frequency of the data. You can also call on the density function directly via the density() command.
```{r}
density(df$thalachh)
```
## Using the Density Function to Draw a Graph
```{r}
plot(density(df$oldpeak))
```
```{r}
```


```{r}
plot(density(df$age))
```
```{r}
hist(df$age, freq = F)
lines(density(df$age), lty = 2)
lines(density(df$age, k = 'rectangular'))
```
## Generates n random numbers from the normal distribution with mean of 0 and standard deviation of 1
```{r}
head(rnorm(df$trtbps, mean = 0, sd = 1))
```
## Returns the probability for the quantile q
```{r}
head(pnorm(df$thalachh, mean = 0, sd = 1))
```
## Returns the quantile for a given probability p
```{r}
head(qnorm(df$oldpeak, mean = 0, sd = 1))
```
## Gives the density function for values x
```{r}
head(dnorm(df$trtbps, mean = 0, sd = 1))
```
## Quantile-Quantile Plot
```{r}
qqnorm(df$age)
```
```{r}
qqnorm(df$trtbps)

```
```{r}
qqnorm(df$oldpeak, main = 'QQ plot of df$oldpeak', xlab = 'Theoretical', 
ylab = 'Quantiles for df$oldpeak')
qqline(df$oldpeak, lwd = 2, lty = 2)
```
## can also plot one distribution against another as a quantile-quantile plot using the qqplot() command.
```{r}
qqplot(df$age, df$age)
```
## Would be useful to draw a straight line on your qqplot() and you can do that using the abline() command. This command uses the properties of a straight line (that is, y = a + bx) to produce a line on an existing plot. The general form of the command is: abline(a = intercept, b = slope)
## Lm(), which carries out linear modeling. This command determines the line of best fit between the x and y values in your qqp object.
```{r}
qqp = qqplot(df$thalachh, df$thalachh)
abline(lm(qqp$y ~ qqp$x))
```
## The basic method of applying a t-test is to compare two vectors of numeric data
```{r}
t.test(df$age, df$oldpeak)
```
## Can override the default and use the classic t-test by adding the var.equal = TRUE instruction, which forces the command to assume that the variance of the two samples is equal.
```{r}
t.test(df$age, df$thalachh, var.equal = TRUE)
```
## can also carry out a one-sample t-test. In this version you supply the name of a single vector and the mean to compare it to (this defaults to 0):
```{r}
t.test(df$age, mu = 5)
```
## Using Directional Hypotheses
```{r}
t.test(df$age, mu = 5, alternative = 'greater')
```
## Formula Syntax and Subsetting Samples in the t-Test
```{r}
t.test(df$age ~ df$sex, data = df, subset = df$sex %in% c(0 , 1))
```
## Two-Sample U-Test
```{r}
wilcox.test(df$age, df$trtbps)
```
## Carries out a basic correlation between x and y . If x is a matrix or data frame, y can be omitted
```{r}
cor(df$age, df$trtbps)
```
## Determines covariance between x and y . If x is a matrix or data frame, y can be omitted
```{r}
x = cov(df$age, df$trtbps)
x
```
## The cov2cor() command is used to determine the correlation from a matrix of covariance in the following example:
```{r}
v = as.matrix(x)
cov2cor(v)
```

## Significance Testing in Correlation Tests
```{r}
cor.test(df$thall, df$oldpeak)
```
## Chi-squared tests of association can be carried out using the chisq.test() command.
```{r}
chisq.test(df$oldpeak)
```
## BoxPlot’s:
```{r}
boxplot(df$age)
```
```{r}
boxplot(df$thall)
```
```{r}
boxplot(df$age, df$trtbps)
```

```{r}
boxplot(df$age ~ df$thall, data = df)
```
```{r}
boxplot(df$thalachh ~ df$age, data = df)
```
```{r}
boxplot(df$age ~ df$sex, data = df)
```
## Horizontal Boxplots
```{r}
boxplot(df$age, horizontal = T)
title(xlab = 'Age')
```
## scatter plot’s
```{r}
library(dplyr)
temp = df %>% filter(df$sex == 0)
plot(temp$age, temp$trtbps, pch = 20)
```
## The pch = instruction refers to the plotting character, and can be specified in one of several ways. You can type an integer value and this code will be reflected in the symbol/character produced. For values from 0 to 25
```{r}
with(df, plot(df$age[df$sex == 1], pch = 2))
```
## with() command can be used to get the particular values based on row(level) conditions
```{r}
with(df, (df$age[df$sex == 1]))
```
## the pairs() command takes all the columns in a data frame and creates a matrix of scatter plots.
```{r}
pairs(~ thall + oldpeak, data = temp)
```
## Line plot
```{r}
plot(temp$chol, type = 'l' )
```
```{r}
plot(temp$age, type = 'b')
```
## Pie chart
```{r}
pie(temp$fbs)


```
```{r}
pie(temp$age)

```
## Dot Chart
```{r}
dotchart(temp$age)
```
## Bar plot
```{r}
barplot(temp$age)
title(xlab = "No of patients", ylab = 'Age')
box()
```
## table() used to get the column’s diff level(type) counts
```{r}
table(df$age)
barplot(temp$age, horiz = T)
title(xlab = 'Age', ylab = 'No of patitents')
box()
```
```{r}
table(df$age)
barplot(temp$trtbps, horiz = T)
title(xlab = 'BP', ylab = 'No of patitents')
box()
```

## the analysis of variance using the aov() command
```{r}
temp.aov = na.omit(aov(temp$age ~ temp$trtbps, data = temp))
temp.aov
```
```{r}
temp.aov = na.omit(aov(temp$age ~ temp$thalachh, data = temp))
temp.aov
```

## To see the classic ANOVA table of results you need to use the summary() command like so
```{r}
summary(temp.aov)
```
## Two-way ANOVA
```{r}
toway = aov(age ~ trtbps * oldpeak, data = temp)
toway
```
```{r}
toway = aov(age ~ sex * oldpeak, data = temp)
toway
```

```{r}
interaction.plot(temp$age, temp$trtbps, temp$oldpeak)
```
```{r}
factor(df$thalachh_setting)
```
## creating new testCol/testRow for addition as a new column/row to the df object (using rep() command)
```{r}
testCol = c(rep(df$age - df$sex, length(df)))
head(testCol)
```
## Adding Rows or Columns
```{r}
test = data.frame(df, testCol)
```


```{r}
head(test)
```
```{r}
test = df
test["Test",] = NA
tail(test)
```
## Column Indexes
```{r}
col(temp, as.factor = F)
```
## Extracting two(2) columns from df
```{r}
x = df[ , 6:11]
head(x)

```
## Simple Column and Row Summaries
```{r}
colMeans(x)
```
```{r}
```


```{r}
rowMeans(x)
```
```{r}
colSums(x)
```
```{r}
rowSums(x)
```
## The apply() command to apply a function over all the rows or columns of a data frame (or matrix)
```{r}
apply(df[ , 10:11], 2, mean)
```
```{r}
apply(df[ , 10:11], 1, mean)
```
```{r}
apply(df[ , 10:11], 2, median)
```
```{r}
apply(df[ , 10:11], 2, var)
```
## Using tapply() to Summarize Using a Grouping Variable
```{r}
tapply(df$age, df$sex, FUN = mean)
```
```{r}
tapply(df$age, df$sex, FUN = var)
```
## The aggregate() command enables you to compute summary statistics for subsets of a data frame or matrix; the result comes out as a single matrix rather than an array item, even with multiple grouping factors
```{r}
aggregate(df[ , 10:11], by = list(df$age), FUN = mean)
```
```{r}
aggregate(cbind(df$sex, df$age), data = df, by = list(df$trtbps), FUN = mean)
```
## The na.omit() command strips out unwanted NA items from vectors and data frames.
```{r}
head(na.omit(df))

```
## ls and objects return a vector of character strings giving the names of the objects in the specified environment
```{r}
objects(df)
ls(df)
```
## Simple lineaR RegReSSion
```{r}
dflm = lm(age ~ trtbps, data = df)
dflm
```
```{r}
cor.test(~ df$trtbps + df$age, data = df)
```
## Linear Model Results Objects
## can extract the coefficients using the coef() command
```{r}
coef(dflm)
```
## can obtain confidence intervals on these coefficients using the confint() command
```{r}
confint(dflm)
```
## Fitted Values
```{r}
head(fitted(dflm))
```
## Residuals
```{r}
head(residuals(dflm))
```
## Formula
```{r}
formula(dflm)
```
```{r}
dflm$call
```
```{r}
formula(df)
```
## Using the segments() Command for Error Bars
```{r}
df.m = apply(df[,10:11], 2, mean)
df.m
```
```{r}
df.sd = apply(df[ , 10:11], 2, sd)
df.sd
```
```{r}
df.s = apply(df[,10:11], 2, sum)
df.s
```
```{r}
df.1 = df.s/df.m
df.1
```

```{r}
df.se = df.sd / sqrt(df.1)
df.se
```
```{r}
df.m + df.se
```
```{r}
max(df.m + df.se)
```
```{r}
df.max = round(max(df.m + df.se) + 0.5, 0)
df.max
```
```{r}
bp = barplot(df.m, ylim = c(0, df.max))
```
```{r}
bp
```
```{r}
bp = barplot(df.m, ylim = c(0, df.max))
segments(bp, df.m + df.se, bp, df.m - df.se)
segments(bp - 0.2, df.m - df.se, bp + 0.2, df.m - df.se)
box()
title(xlab = 'Type of test', ylab = 'Scores')
```
## Creating Mathematical Expressions

```{r}
plot(1:10, 1:10, type = 'n')
opt = par(cex = 1.5)
text(1, 1, expression(hat(x)))
text(2, 2, expression(alpha==x))
text(3, 3, expression(beta==y))
text(4, 4, expression(frac(x, y)))
text(5, 5, expression(sum(x)))
text(6, 6, expression(sum(x^2)))
text(7, 7, expression(bar(x) == sum(frac(x[i], n), i==1, n)))
text(8, 8, expression(sqrt(x)))
text(9, 9, expression(sqrt(x, 3)))
```
```{r}
plot(temp$age ~ temp$trtbps, data = temp, pch = 21, ylab = 'AGE', xlab = 'Trtbps')
points(temp$age ~ temp$trtbps, data = temp, pch = 19)
legend(x = 'topright', legend = c('AGE', 'Trtbps'), pch = c(21,19), bty = 
'n')
```
```{r}
curve(sin, -pi*2, pi*2, lty = 2, lwd = 1.5, ylab = 'Function', ylim = c(-1,1.5))
curve(cos, -pi*2, pi*2, lty = 3, lwd = 1, add = TRUE)
legend(x = 'topright', legend = c('Sine', 'Cosine'), lty = c(2, 3), 
lwd = c(1.5, 1), bty = 'n')
title(main = 'Sine and Cosine functions')
```
```{r}
plot(temp$age ~ temp$oldpeak, data = df, main = 'plot 1')
```
```{r}
plot(temp$age ~ temp$trtbps, data = df, main = 'plot 2')
```
```{r}
plot(temp$thall ~ temp$thalachh, data = df, main = 'plot 3')
```
```{r}
plot(temp$oldpeak ~ temp$age, data = df, main = 'plot 4')
```
```{r}
par(opt)
plot(temp$age ~ temp$oldpeak, data = df, main = 'plot 1')
```
```{r}
plot.new()
plot.new()
plot(temp$oldpeak ~ temp$age, data = df, main = 'plot 4')
```
## Simple customized Functions with multiple lines
```{r}
cummeadian = function(x) {
tmp = seq_along(x)
for(i in 1:length(tmp)) tmp[i] = median(x[1:i])
print(x)}
```
```{r}
cummeadian(temp$age)
```
## One-Line Functions
```{r}
log2 = function(x) log(x, base = 2)
log2
```
```{r}
log2(temp$thall)
```
## Using Default Values in Functions

```{r}
manning = function(radius, gradient, coef=0.1125) (radius^(2/3)*gradient^0.5/coef)
```
```{r}
manning(radius = 1, gradient = 1/500)
```
## Chaining Functions Together with %>%, the Pipe Operator
```{r}
df %>% filter(df$sex == 1) %>% summary()
```
```{r}
df %>% filter(df$sex == 0) %>% summary()
```
## Without the pipe operator, the preceding code would be written like this:
```{r}
summary(filter(df, sex == 0))
```
```{r}
summary(filter(df, age == 65))
```
## Creating a Scatter Plot
```{r}
plot(temp$age, temp$thall)
```
##With ggplot2, you can get a similar result using the ggplot() function
```{r}
library(ggplot2)
```
```{r}
ggplot(temp, aes(x = temp$age, y = temp$oldpeak)) + geom_point()
```
## Creating a Line Graph
```{r}
plot(temp$age, type = 'l')
```
## With ggplot2
```{r}
ggplot(temp, aes(x = age, y = trtbps)) + geom_line()
```
## Creating a Bar Graph
```{r}
ggplot(temp, aes(x = temp$age, y = temp$thalachh)) + geom_col()
```
## Creating a Histogram
```{r}
ggplot(temp, aes(x = temp$age)) + geom_histogram(binwidth = .5)
```
## Creating a Box Plot

```{r}
ggplot(temp, aes(x = temp$age, y = temp$trtbps)) + geom_boxplot()
```
```{r}
ggplot(temp, aes(x = age, y = trtbps)) + geom_col(fill = "blue", colour = "black")
```
## Grouping Bars Together
```{r}
ggplot(df, aes(x = sex, y = trtbps, fill = age)) + geom_col(position = "dodge")
```
```{r}
ggplot(df, aes(x = age, y = trtbps, fill = oldpeak)) + geom_col(position = "dodge")
```
```{r}
ggplot(df, aes(x = age, y = trtbps, fill = thall)) + geom_col(position = "dodge")
```
```{r}
ggplot(df, aes(x = age, y = oldpeak, fill = sex)) + geom_col(position = "dodge")
```
```{r}
ggplot(df, aes(x = age, y = chol, fill = sex)) + geom_col(position = "dodge")
```
```{r}
ggplot(df, aes(x = age, y = sex, fill = thall)) + geom_col(position = "dodge")
```
## Making a Cleveland Dot Plot
```{r}
ggplot(df, aes(x = age, y = trtbps)) + geom_point()
```
```{r}
ggplot(df, aes(x = age, y = oldpeak)) +
 geom_point(size = 3) + # Use a larger dot
 theme_bw() +
 theme(
 panel.grid.major.x = element_blank(),
 panel.grid.minor.x = element_blank(),
 panel.grid.major.y = element_line(colour = "grey60", linetype = "dashed")
 )
```
```{r}
ggplot(df, aes(x = sex, y = age)) +
geom_segment(aes(yend = oldpeak), xend = 0, colour = "grey50") + 
  geom_point(size = 2) 
```
```{r}
ggplot(df,aes(x=age, y=trtbps, colour= sex)) + geom_point()
```
```{r}
ggplot(df,aes(x=age, y=trtbps, colour = sex)) + geom_point()
```
```{r}
plot(df)
```
```{r}
ggplot(df, aes(x = df$age, y = df$sex)) +
 geom_point(size = 1.5)
```
```{r}
tt <- df %>%
 filter(df$sex == 0,) %>%
 select(age, trtbps, thall, oldpeak, cp)
head(tt)
```
```{r}
tt <- df %>%
 filter(df$sex == 1) %>%
 select(thalachh, chol, thall, oldpeak, cp)
head(tt)
```
```{r}
tt = df %>% filter(df$age == 50) %>% select(age, trtbps, thall, oldpeak, cp)
head(tt)
```
```{r}
tt = df %>% filter(df$age == 60) %>% select(age, sex, trtbps, thall, oldpeak, cp)
head(tt)
```
```{r}
ggplot(df, aes(x = thall, y = trtbps)) +
geom_segment(aes(yend = age), xend = 0, colour = "grey50") + 
  geom_point(size = 2)
```
```{r}
ggplot(df, aes(x = age, y = trtbps)) +
 geom_point(size = 3) + # Use a larger dot
 theme_bw() +
 theme()
```
```{r}
tt = df %>% group_by(df$sex) %>% summary()
tt
```



